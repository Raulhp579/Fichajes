import{$ as E,$a as t,$d as ee,Ab as M,Ad as Y,Bd as $,Gd as Z,Ha as T,Ib as w,Id as J,Jb as O,Jd as K,Kb as N,Ob as z,Pd as Q,Rd as W,Ua as p,Ud as X,Va as m,X as _,Xa as F,Ya as D,Za as v,_a as e,aa as k,ab as f,bc as B,cc as V,ce as te,dc as j,hb as I,id as G,jb as g,jd as q,kd as H,la as C,lb as u,ld as L,md as R,p as b,pc as A,wa as l,wb as h,wd as U,yb as a,yd as x,zb as d}from"./chunk-FMOC5MYT.js";import{a as y,b as P}from"./chunk-IMPBB4AK.js";var ie=(o,n)=>n.date;function ae(o,n){if(o&1&&(e(0,"span",4),a(1),t()),o&2){let i,r=u();l(),d((i=r.user())==null||i.name==null?null:i.name.charAt(0).toUpperCase())}}function oe(o,n){o&1&&(e(0,"mat-icon"),a(1,"person"),t())}function re(o,n){if(o&1&&(e(0,"div",14)(1,"span",15),a(2),t(),e(3,"span",16),a(4),t()()),o&2){let i=n.$implicit;l(2),d(i.day),l(2),M("",i.hours,"h")}}function le(o,n){if(o&1&&(e(0,"div",10)(1,"div",11),f(2,"canvas",12),t(),e(3,"div",13),F(4,re,5,2,"div",14,ie),t()()),o&2){let i=u();l(2),v("data",i.lineChartData)("options",i.lineChartOptions)("legend",i.lineChartLegend)("type","line"),l(2),D(i.recentStats())}}function se(o,n){o&1&&(e(0,"div",22),a(1,"Please check the fields"),t())}function de(o,n){if(o&1){let i=I();e(0,"div",10)(1,"form",17),g("ngSubmit",function(){E(i);let s=u();return k(s.onChangePassword())}),e(2,"div",18)(3,"label"),a(4,"Contrase\xF1a Actual"),t(),f(5,"input",19),t(),e(6,"div",18)(7,"label"),a(8,"Nueva Contrase\xF1a"),t(),f(9,"input",20),t(),e(10,"div",18)(11,"label"),a(12,"Confirmar Nueva Contrase\xF1a"),t(),f(13,"input",21),t(),p(14,se,2,0,"div",22),e(15,"button",23),a(16," Actualizar "),t()()()}if(o&2){let i=u();l(),v("formGroup",i.passwordForm),l(13),m(i.passwordForm.invalid&&i.passwordForm.dirty?14:-1),l(),v("disabled",i.passwordForm.invalid)}}function ce(o,n){if(o&1&&(e(0,"div",10)(1,"div",24)(2,"div",25)(3,"div",26)(4,"mat-icon"),a(5,"email"),t()(),e(6,"div")(7,"label"),a(8,"Email"),t(),e(9,"p"),a(10),t()()(),e(11,"div",25)(12,"div",26)(13,"mat-icon"),a(14,"calendar_today"),t()(),e(15,"div")(16,"label"),a(17,"Miembro desde"),t(),e(18,"p"),a(19),w(20,"date"),t()()(),e(21,"div",25)(22,"div",26)(23,"mat-icon"),a(24,"badge"),t()(),e(25,"div")(26,"label"),a(27,"ID Usuario"),t(),e(28,"p"),a(29),t()()()()()),o&2){let i,r,s,c=u();l(10),d((i=c.user())==null?null:i.email),l(9),d(N(20,3,(r=c.user())==null?null:r.created_at,"mediumDate")),l(10),M("#",(s=c.user())==null?null:s.id)}}var ne=class o{userService=_(L);authService=_(R);fb=_(Q);user=C(null);passwordForm;currentTab=C("activity");setTab(n){this.currentTab.set(n)}stats=C([]);recentStats=z(()=>this.stats().slice(-2));lineChartData={labels:[],datasets:[{data:[],label:"Horas trabajadas",fill:!0,tension:.5,borderColor:"#1a237e",backgroundColor:"rgba(26, 35, 126, 0.1)",pointBackgroundColor:"#1a237e",pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:"#1a237e"}]};lineChartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,grid:{color:"rgba(0,0,0,0.05)"}},x:{grid:{display:!1}}}};lineChartLegend=!1;constructor(){this.passwordForm=this.fb.group({current_password:["",x.required],new_password:["",[x.required,x.minLength(8)]],new_password_confirmation:["",x.required]},{validators:this.passwordMatchValidator})}passwordMatchValidator(n){return n.get("new_password")?.value===n.get("new_password_confirmation")?.value?null:{mismatch:!0}}async ngOnInit(){try{let n=await b(this.userService.userInfo());this.user.set(n),this.loadStatistics()}catch(n){console.error(n)}}async loadStatistics(){try{let n=await b(this.userService.getStatistics());this.stats.set(n);let i=n.map(s=>s.day),r=n.map(s=>s.hours);this.lineChartData=P(y({},this.lineChartData),{labels:i,datasets:[P(y({},this.lineChartData.datasets[0]),{data:r})]})}catch(n){console.error("Error loading stats",n)}}async onChangePassword(){if(!this.passwordForm.invalid)try{let{current_password:n,new_password:i,new_password_confirmation:r}=this.passwordForm.value;await b(this.authService.changePassword({current_password:n,new_password:i,new_password_confirmation:r})),this.passwordForm.reset(),alert("Contrase\xF1a actualizada correctamente")}catch(n){console.error("Error changing password",n),alert(n.error?.message||"Error al cambiar la contrase\xF1a")}}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=T({type:o,selectors:[["app-profile"]],decls:33,vars:16,consts:[[1,"profile-container"],[1,"glass-card"],[1,"profile-header"],[1,"avatar-wrapper"],[1,"avatar-text"],[1,"header-info"],[1,"role-pill"],[1,"tabs-container"],[1,"tab-btn",3,"click"],[1,"content-area"],[1,"tab-content","fade-in"],[1,"chart-wrapper"],["baseChart","",3,"data","options","legend","type"],[1,"stats-row"],[1,"stat-pill"],[1,"stat-day"],[1,"stat-hours"],[1,"security-form",3,"ngSubmit","formGroup"],[1,"input-group"],["formControlName","current_password","type","password","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"],["formControlName","new_password","type","password","placeholder","M\xEDnimo 8 caracteres"],["formControlName","new_password_confirmation","type","password","placeholder","Repite la contrase\xF1a"],[1,"error-msg"],["type","submit",1,"action-btn",3,"disabled"],[1,"info-list"],[1,"info-item"],[1,"icon-box"]],template:function(i,r){if(i&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),p(4,ae,2,1,"span",4)(5,oe,2,0,"mat-icon"),t(),e(6,"div",5)(7,"h1"),a(8),w(9,"titlecase"),t(),e(10,"p",6),a(11),w(12,"titlecase"),t()()(),e(13,"div",7)(14,"button",8),g("click",function(){return r.setTab("activity")}),e(15,"mat-icon"),a(16,"bar_chart"),t(),e(17,"span"),a(18,"Actividad"),t()(),e(19,"button",8),g("click",function(){return r.setTab("security")}),e(20,"mat-icon"),a(21,"lock"),t(),e(22,"span"),a(23,"Seguridad"),t()(),e(24,"button",8),g("click",function(){return r.setTab("info")}),e(25,"mat-icon"),a(26,"info"),t(),e(27,"span"),a(28,"Informaci\xF3n"),t()()(),e(29,"div",9),p(30,le,6,4,"div",10),p(31,de,17,3,"div",10),p(32,ce,30,6,"div",10),t()()()),i&2){let s,c,S;l(4),m((s=r.user())!=null&&s.name?4:5),l(4),d(O(9,12,(c=r.user())==null?null:c.name)),l(3),d(O(12,14,(S=r.user())==null?null:S.role)),l(3),h("active",r.currentTab()==="activity"),l(5),h("active",r.currentTab()==="security"),l(5),h("active",r.currentTab()==="info"),l(6),m(r.currentTab()==="activity"?30:-1),l(),m(r.currentTab()==="security"?31:-1),l(),m(r.currentTab()==="info"?32:-1)}},dependencies:[j,ee,G,H,q,te,X,W,Z,U,Y,$,K,J,A,B,V],styles:[".profile-container[_ngcontent-%COMP%]{min-height:calc(100vh - 64px);width:100%;display:flex;align-items:center;justify-content:center;font-family:Outfit,Inter,sans-serif;overflow:hidden;position:relative;background-color:#f8f9fa}.profile-container[_ngcontent-%COMP%]:before{display:none}.glass-card[_ngcontent-%COMP%]{position:relative;z-index:10;width:100%;max-width:500px;background:#fff;border-radius:32px;border:1px solid rgba(0,0,0,.05);box-shadow:0 25px 50px -12px #0000000d;padding:40px;color:#333;display:flex;flex-direction:column;gap:32px;transition:all .3s ease}.profile-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;text-align:center;gap:16px}.avatar-wrapper[_ngcontent-%COMP%]{width:100px;height:100px;border-radius:50%;background:#eef2ff;border:2px solid #e0e7ff;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 6px -1px #0000000d;color:#1a237e}.avatar-text[_ngcontent-%COMP%]{font-size:40px;font-weight:700;color:#1a237e}.avatar-wrapper[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;color:#1a237e}.header-info[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:24px;font-weight:600;letter-spacing:-.5px;color:#1a1a1a}.role-pill[_ngcontent-%COMP%]{display:inline-block;margin-top:8px;padding:6px 16px;background:#e0e7ff;border-radius:20px;font-size:12px;letter-spacing:1px;text-transform:uppercase;color:#1a237e;font-weight:600}.tabs-container[_ngcontent-%COMP%]{display:flex;justify-content:center;background:#f1f5f9;padding:4px;border-radius:16px}.tab-btn[_ngcontent-%COMP%]{flex:1;background:transparent;border:none;color:#64748b;padding:10px;border-radius:12px;cursor:pointer;display:flex;justify-content:center;align-items:center;gap:8px;transition:all .2s ease;font-size:14px;font-weight:500}.tab-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.tab-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:none}.tab-btn[_ngcontent-%COMP%]:hover{color:#1a237e;background:#1a237e0d}.tab-btn.active[_ngcontent-%COMP%]{background:#fff;color:#1a237e;box-shadow:0 2px 4px #0000000d}.content-area[_ngcontent-%COMP%]{min-height:200px}.fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.chart-wrapper[_ngcontent-%COMP%]{background:#f8fafc;border-radius:16px;padding:16px;margin-bottom:16px;border:1px solid #e2e8f0}.stats-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:12px}.stat-pill[_ngcontent-%COMP%]{flex:1;background:#f8fafc;padding:12px;border-radius:12px;display:flex;flex-direction:column;align-items:center;gap:4px;border:1px solid #e2e8f0}.stat-day[_ngcontent-%COMP%]{font-size:12px;color:#64748b}.stat-hours[_ngcontent-%COMP%]{font-size:18px;font-weight:700;color:#10b981}.security-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.input-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px;color:#64748b;text-transform:uppercase;letter-spacing:.5px;font-weight:600}.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background:#f8fafc;border:1px solid #e2e8f0;padding:12px 16px;border-radius:12px;color:#333;font-family:inherit;font-size:14px;outline:none;transition:border-color .2s}.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#1a237e;background:#fff}.action-btn[_ngcontent-%COMP%]{background:#1a237e;border:none;padding:14px;border-radius:12px;color:#fff;font-weight:600;cursor:pointer;transition:transform .2s,box-shadow .2s,background-color .2s}.action-btn[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 4px 12px #1a237e4d;background:#283593}.action-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;background:#9fa8da}.info-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.info-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:16px;background:#f8fafc;border-radius:16px;border:1px solid #e2e8f0}.info-item[_ngcontent-%COMP%]   .icon-box[_ngcontent-%COMP%]{width:40px;height:40px;background:#e0e7ff;border-radius:10px;display:flex;align-items:center;justify-content:center;color:#1a237e}.info-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:12px;color:#64748b;margin-bottom:2px}.info-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:15px;font-weight:600;color:#333}@media(min-width:600px){.glass-card[_ngcontent-%COMP%]{padding:60px;max-width:600px}.tab-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:inline}}"]})};export{ne as Profile};
